    <!DOCTYPE html>
    <html lang="el">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Μαθητικό Στέκι</title>
    <link rel="stylesheet" href="../style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;400&display=swap" rel="stylesheet">

    <style>
            body { font-family: Arial, sans-serif; background: #d1c5b8; }
            .wizard { width: 600px; margin: 30px auto; background: #f5f5f5; padding: 20px; border-radius: 10px; }
            .steps { text-align: center; margin-bottom: 20px; }
            .steps span { display: inline-block; width: 30px; height: 30px; line-height: 30px; border-radius: 50%; background: #aaa; color: #fff; margin: 0 5px; }
            .steps .active { background: #5b3c2a; }
            .step { display: none; }
            .step.active { display: block; }
            .buttons { display: flex; justify-content: space-between; margin-top: 20px; }
            button { background: #5b3c2a; color: #fff; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
            button:hover { opacity: 0.9; }
            .radio-group { display: flex; flex-direction: column; gap: 10px; margin-top: 15px; }
            .radio-group label { background: #fff; padding: 10px; border-radius: 5px; border: 1px solid #ccc; cursor: pointer; }
            .radio-group input { margin-right: 10px; }
            input[type="number"], select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; margin-bottom: 10px; }
            
            /* Styles για ειδικά μαθήματα */
            .eidiko-mathima { margin-bottom: 15px; }
            .eidiko-mathima label { display: block; margin-bottom: 5px; font-weight: bold; }
            
            /* Styles για αποτελέσματα */
            .results-header { text-align: center; margin-bottom: 20px; }
            .results-header h3 { color: #5b3c2a; margin-bottom: 5px; }
            .scholes-list { max-height: 400px; overflow-y: auto; }
            .scholi-item { background: #fff; border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-bottom: 10px; }
            .scholi-item.top-choice { border-color: #5b3c2a; background: #f9f7f5; }
            .scholi-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
            .scholi-header h4 { margin: 0; color: #5b3c2a; }
            .rank { background: #5b3c2a; color: #fff; padding: 3px 8px; border-radius: 15px; font-size: 12px; }
            .scholi-details { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
            .moria-info, .vasi-info, .difference-info { text-align: center; }
            .label { display: block; font-size: 12px; color: #666; margin-bottom: 3px; }
            .value { display: block; font-weight: bold; font-size: 14px; }
            .value.positive { color: #28a745; }
            .no-results { text-align: center; padding: 40px; color: #666; }
            
            /* Styles για Excel export button */
            #export-excel-btn { 
                background: linear-gradient(135deg, #28a745, #20c997); 
                color: white; 
                border: none; 
                padding: 12px 24px; 
                border-radius: 8px; 
                cursor: pointer; 
                font-size: 16px; 
                font-weight: bold;
                transition: all 0.3s ease;
                box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
            }
            #export-excel-btn:hover { 
                background: linear-gradient(135deg, #218838, #1e7e34);
                transform: translateY(-2px);
                box-shadow: 0 6px 12px rgba(40, 167, 69, 0.4);
            }
            #export-excel-btn:active {
                transform: translateY(0);
                box-shadow: 0 2px 4px rgba(40, 167, 69, 0.3);
            }
        </style>


    </head>
    <body>
  <header>
    <div class="topbar">
      <div class="logo"><img src="logo/b.png" alt="logo"></div>
      <nav>
        <a href="#" style="color: #960e0e;">Αρχική Σελίδα</a>
        <div class="dropdown">
          <a href="main-page/programs.html">Πρόγραμμα Σπουδών</a>
          <div class="dropdown-content">
            <a href="main-page/programs.html">Πλήρες Πρόγραμμα</a>
            <a href="#">Μαθήματα ΓΕΛ</a>
            <a href="#">Μαθήματα ΕΠΑΛ</a>
            <a href="#">Ιδιαίτερα Μαθήματα</a>
          </div>
        </div>

        <div class="dropdown">
          <a href="main-page/panelladikes.html">Πανελλαδικές Εξετάσεις</a>
          <div class="dropdown-content">
            <a href="#">Όλα τα παρακάτω</a>
            <a href="moria-calculator.html">Υπολογισμός Μορίων</a>
            <a href="main-page/pallia-themata.html">Παλιά Θέματα</a>
            <a href="#">Τράπεζα Θεμάτων</a>
            <a href="admin-vaseis-scholon.html">Βάσεις Σχολών</a>
            <a href="#">Μηχανογραφικό</a>
          </div>
        </div>
        <a href="main-page/photos.html">Φωτογραφίες</a>
        <a href="#">Σχετικά με εμάς</a>
      </nav>
      <div class="icons">
        <a href="#"><img src="\elements\Group 17.svg" alt="fb" class="facebook-icon"></a>
        <a href="#"><img src="\elements\mdi_instagram.svg" alt="insta" class="instagram-icon"></a>
        <a href="#"><img src="\elements\phone.svg" alt="phone"></a>
        <a href="#"><img src="\elements\mail.svg" alt="mail"></a>
      </div>
      <a href="index2.html" class="login-btn" style="text-decoration: none;">Είσοδος</a>
    </div>
  </header>
    
    <main>
        <div >
    <h1>Υπολογισμός Μορίων</h1>
    
        </div>


        <div class="wizard">
        <div class="steps">
            <span class="active">1</span>
            <span>2</span>
            <span>3</span>
            <span>4</span>
            <span>5</span>
        </div>

        <!-- Βήμα 1 -->
        <div class="step active">
            <h2>Βήμα 1ο: Επιλέξτε το Λύκειο σας</h2>
            <div class="radio-group" id="lykeio-options">
                <!-- Οι επιλογές θα φορτωθούν δυναμικά -->
            </div>
        </div>

        <!-- Βήμα 2 -->
        <div class="step">
            <h2>Βήμα 2ο: Επιλέξτε το πεδίο σας</h2>
            <div class="radio-group" id="pedio-options">
                <!-- Οι επιλογές θα φορτωθούν δυναμικά βάσει του λυκείου -->
            </div>
        </div>

        <!-- Βήμα 3 -->
        <div class="step">
            <h2>Βήμα 3ο: Συμπληρώστε τους Βαθμούς σας</h2>
            <div id="mathimata-container">
                <!-- Τα μαθήματα θα προστεθούν δυναμικά -->
            </div>
        </div>

        <!-- Βήμα 4 -->
        <div class="step">
            <h2>Βήμα 4ο: Συμπληρώστε τα Ειδικά Μαθήματα</h2>
            <div id="eidika-container">
                <!-- Τα ειδικά μαθήματα θα προστεθούν δυναμικά -->
            </div>
        </div>

        <!-- Βήμα 5 -->
        <div class="step">
            <h2>Βήμα 5ο: Αποτελέσματα - Κατάλληλες Σχολές</h2>
            <div id="step5-results">
                <p>Παρακαλώ συμπληρώστε όλα τα προηγούμενα βήματα για να δείτε τις κατάλληλες σχολές.</p>
            </div>
            
            <!-- Κουμπί για Excel export - θα εμφανιστεί μόνο όταν υπάρχουν αποτελέσματα -->
            <div id="excel-export-container" style="display: none; text-align: center; margin-top: 20px;">
                <button id="export-excel-btn" style="background: #28a745; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 16px;">
                     Κατέβασμα ως Excel (.xlsx)
                </button>
                <p style="color: #666; font-size: 12px; margin-top: 5px;">
                    Κατεβάστε τα αποτελέσματα σε μορφή Excel για περαιτέρω ανάλυση
                </p>
            </div>
        </div>

        <div class="buttons">
            <button id="prevBtn">Πίσω</button>
            <button id="nextBtn">Επόμενο</button>
        </div>
    </div>

    <script>
        let currentStep = 0;
        const steps = document.querySelectorAll(".step");
        const circles = document.querySelectorAll(".steps span");
        const nextBtn = document.getElementById("nextBtn");
        const prevBtn = document.getElementById("prevBtn");
        
        // Δεδομένα του χρήστη
        let userData = {
            lykeio: '',
            pedio: '',
            vathmoi: {},
            eidika: []
        };

        // Αρχικοποίηση του συστήματος
        async function initSystem() {
            await moriaCalculator.loadSystemConfig();
            loadLykeioOptions();
        }

        // Φόρτωση επιλογών λυκείου
        function loadLykeioOptions() {
            const container = document.getElementById('lykeio-options');
            if (!moriaCalculator.systemConfig) {
                container.innerHTML = '<p>Σφάλμα φόρτωσης ρυθμίσεων</p>';
                return;
            }

            let html = '';
            moriaCalculator.systemConfig.lykeiaTypes.forEach(lykeio => {
                html += `
                    <label>
                        <input type="radio" name="lykeio" value="${lykeio.id}" onchange="loadPedioOptions('${lykeio.id}')"> 
                        ${lykeio.name}
                    </label>
                `;
            });
            container.innerHTML = html;
        }

        // Φόρτωση επιλογών πεδίου βάσει λυκείου
        function loadPedioOptions(lykeioId) {
            userData.lykeio = lykeioId;
            const container = document.getElementById('pedio-options');
            
            const availablePedia = moriaCalculator.getAvailablePedia(lykeioId);
            if (availablePedia.length === 0) {
                container.innerHTML = '<p>Δεν βρέθηκαν διαθέσιμα πεδία</p>';
                return;
            }

            let html = '';
            availablePedia.forEach(pedio => {
                html += `
                    <label>
                        <input type="radio" name="pedio" value="${pedio.id}" onchange="setPedio('${pedio.id}')"> 
                        ${pedio.name}
                    </label>
                `;
            });
            container.innerHTML = html;
        }

        // Ρύθμιση πεδίου
        function setPedio(pedioId) {
            userData.pedio = pedioId;
        }

        function showStep(n) {
            steps.forEach((step, index) => step.classList.toggle("active", index === n));
            circles.forEach((circle, index) => circle.classList.toggle("active", index === n));
            prevBtn.style.display = n === 0 ? "none" : "inline-block";
            nextBtn.textContent = n === steps.length - 1 ? "Ολοκλήρωση" : "Επόμενο";
            
            // Ειδική λογική για κάθε βήμα
            if (n === 2) { // Βήμα 3 - Μαθήματα
                updateMathimataContainer();
            } else if (n === 3) { // Βήμα 4 - Ειδικά μαθήματα
                updateEidikaContainer();
            } else if (n === 4) { // Βήμα 5 - Αποτελέσματα
                calculateAndShowResults();
            }
        }

        function updateMathimataContainer() {
            const container = document.getElementById('mathimata-container');
            
            if (!userData.pedio) {
                container.innerHTML = '<p>Παρακαλώ επιλέξτε πρώτα το πεδίο σας.</p>';
                return;
            }

            const mathimata = moriaCalculator.getMathimataForPedio(userData.pedio);
            if (mathimata.length === 0) {
                container.innerHTML = '<p>Δεν βρέθηκαν μαθήματα για αυτό το πεδίο.</p>';
                return;
            }

            let html = '';
            mathimata.forEach(mathima => {
                const required = mathima.required ? ' *' : '';
                html += `
                    <input 
                        type="number" 
                        id="vathmos-${mathima.key}" 
                        placeholder="${mathima.name}${required}" 
                        step="0.1" 
                        min="0" 
                        max="20"
                        value="${userData.vathmoi[mathima.key] || ''}"
                        ${mathima.required ? 'required' : ''}
                    >
                `;
            });
            
            container.innerHTML = html;
        }

        function updateEidikaContainer() {
            const container = document.getElementById('eidika-container');
            
            if (!userData.pedio) {
                container.innerHTML = '<p>Παρακαλώ επιλέξτε πρώτα το πεδίο σας.</p>';
                return;
            }

            const eidikaMathimata = moriaCalculator.getEidikaMathimataForPedio(userData.pedio);
            if (eidikaMathimata.length === 0) {
                container.innerHTML = '<p>Δεν υπάρχουν ειδικά μαθήματα για αυτό το πεδίο.</p>';
                return;
            }

            let html = '';
            for (let i = 1; i <= 2; i++) {
                html += `
                    <div class="eidiko-mathima">
                        <label>${i}ο Ειδικό Μάθημα:</label>
                        <select id="eidiko${i}-select">
                            <option value="">Κανένα</option>
                `;
                
                eidikaMathimata.forEach(mathima => {
                    html += `<option value="${mathima}">${mathima}</option>`;
                });
                
                html += `
                        </select>
                        <input type="number" id="eidiko${i}-vathmos" placeholder="Βαθμός" step="0.1" min="0" max="20">
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }

        function collectUserData() {
            // Βήμα 3 - Βαθμοί
            if (userData.pedio) {
                const mathimata = moriaCalculator.getMathimataForPedio(userData.pedio);
                mathimata.forEach(mathima => {
                    const input = document.getElementById(`vathmos-${mathima.key}`);
                    if (input && input.value) {
                        userData.vathmoi[mathima.key] = parseFloat(input.value);
                    }
                });
            }
            
            // Βήμα 4 - Ειδικά μαθήματα
            userData.eidika = [];
            
            for (let i = 1; i <= 2; i++) {
                const select = document.getElementById(`eidiko${i}-select`);
                const vathmos = document.getElementById(`eidiko${i}-vathmos`);
                if (select && vathmos && select.value && vathmos.value) {
                    userData.eidika.push({
                        mathima: select.value,
                        vathmos: parseFloat(vathmos.value)
                    });
                }
            }
        }

        async function calculateAndShowResults() {
            collectUserData();
            
            if (!userData.pedio) {
                document.getElementById('step5-results').innerHTML = 
                    '<p>Παρακαλώ επιλέξτε το πεδίο σας στο βήμα 2.</p>';
                return;
            }

            // Φόρτωση δεδομένων σχολών
            await moriaCalculator.loadScholesData(userData.pedio);
            
            // Εμφάνιση αποτελεσμάτων
            moriaCalculator.displayResults(userData.vathmoi, userData.eidika);
        }

        function validateStep(stepIndex) {
            switch(stepIndex) {
                case 0: // Βήμα 1
                    return userData.lykeio !== '';
                case 1: // Βήμα 2
                    return userData.pedio !== '';
                case 2: // Βήμα 3
                    collectUserData();
                    const mathimata = moriaCalculator.getMathimataForPedio(userData.pedio);
                    const requiredMathimata = mathimata.filter(m => m.required);
                    return requiredMathimata.every(m => userData.vathmoi[m.key] && userData.vathmoi[m.key] > 0);
                case 3: // Βήμα 4
                    return true; // Τα ειδικά μαθήματα είναι προαιρετικά
                default:
                    return true;
            }
        }

        nextBtn.addEventListener("click", () => {
            if (!validateStep(currentStep)) {
                alert('Παρακαλώ συμπληρώστε τα απαραίτητα πεδία.');
                return;
            }
            
            if (currentStep < steps.length - 1) {
                currentStep++;
                showStep(currentStep);
            } else {
                // Ολοκλήρωση
                alert('Ευχαριστούμε! Τα αποτελέσματα εμφανίζονται παραπάνω.');
            }
        });

        prevBtn.addEventListener("click", () => {
            if (currentStep > 0) {
                currentStep--;
                showStep(currentStep);
            }
        });

        // Αρχικοποίηση όταν φορτώνεται η σελίδα
        document.addEventListener('DOMContentLoaded', async () => {
            await initSystem();
            showStep(currentStep);
        });
    </script>
    


    </main>
    <footer>
        <div class="footer-content">
        <div class="footer-logo">Μαθητικό Στέκι</div>
        <div class="footer-links"  data-id="footer-links">
            <span>Καθηγητές:</span>
            <span>...</span>
        </div>
        <div class="footer-map" >
            <img src="map.png" alt="Χάρτης">
        </div>
        </div>
        <div class="footer-bottom">
        &copy; 2025 Μαθητικό Στέκι
        </div>
    </footer>
        <!-- XLSX Library για Excel export -->
        <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
        <script src="../moria-calculator.js"></script>
        <script src="../main.js"></script>
        <script src="../client-text.js"></script>


    </body>
    </html>
