<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Μηχανογραφικό - Μαθητικό Στέκι</title>
  <link rel="stylesheet" href="../style.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;400&display=swap" rel="stylesheet">
  <style>
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .filters-section {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      align-items: end;
    }
    
    .filter-group {
      display: flex;
      flex-direction: column;
      min-width: 150px;
    }
    
    .filter-group label {
      font-weight: bold;
      margin-bottom: 5px;
      color: #5b3c2a;
    }
    
    .filter-group select {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 14px;
    }
    
    .clear-btn {
      background: #6c757d;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 5px;
      cursor: pointer;
      height: fit-content;
    }
    
    .clear-btn:hover {
      background: #5a6268;
    }
    
    .pdf-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .pdf-item {
      background: white;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }
    
    .pdf-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }
    
    .pdf-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .pdf-icon {
      width: 40px;
      height: 40px;
      margin-right: 15px;
      color: #d32f2f;
    }
    
    .pdf-title {
      font-weight: bold;
      font-size: 16px;
      color: #5b3c2a;
      margin: 0;
    }
    
    .pdf-info {
      margin-bottom: 15px;
    }
    
    .pdf-meta {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      color: #666;
      margin-bottom: 5px;
    }
    
    .pdf-description {
      font-size: 14px;
      color: #666;
      line-height: 1.4;
    }
    
    .pdf-actions {
      display: flex;
      gap: 10px;
    }
    
    .btn-view {
      flex: 1;
      background: #28a745;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 5px;
      cursor: pointer;
      text-decoration: none;
      text-align: center;
      font-size: 14px;
    }
    
    .btn-view:hover {
      background: #218838;
    }
    
    .btn-download {
      flex: 1;
      background: #007bff;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 5px;
      cursor: pointer;
      text-decoration: none;
      text-align: center;
      font-size: 14px;
    }
    
    .btn-download:hover {
      background: #0056b3;
    }
    
    .btn-view:disabled,
    .btn-download:disabled {
      background: #ccc;
      cursor: not-allowed;
      opacity: 0.6;
    }
    
    .btn-view:disabled:hover,
    .btn-download:disabled:hover {
      background: #ccc;
    }
    
    .loading {
      text-align: center;
      padding: 40px;
      color: #666;
      font-size: 18px;
    }
    
    .no-files {
      text-align: center;
      padding: 40px;
      color: #666;
    }
    
    .no-files h3 {
      margin-bottom: 10px;
    }
    
    .pdf-badge {
      display: inline-block;
      background: #5b3c2a;
      color: white;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      margin-left: 10px;
    }
    
    .info-notice {
      background: #fff3cd;
      border: 1px solid #ffeeba;
      color: #856404;
      padding: 15px;
      border-radius: 5px;
      margin-bottom: 20px;
    }
    
    .info-notice a {
      color: #5b3c2a;
      font-weight: bold;
    }
    
    .description-section {
      background: #e8f4f8;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      border-left: 4px solid #007bff;
    }
    
    .description-section h2 {
      margin-top: 0;
      color: #5b3c2a;
    }
    
    .specialty-badge {
      display: inline-block;
      background: #17a2b8;
      color: white;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      margin-left: 5px;
    }
  </style>
</head>
<body>
  <header>
      <div class="topbar">
        <div class="logo"><img src="logo.png" alt="logo"></div>
        <nav>
          <a href="#">Αρχική Σελίδα</a>
          <a href="#">Προγράμματα</a>
          <a href="#">Πανελλαδικές Εξετάσεις</a>
          <a href="#">Φωτογραφίες</a>
          <a href="#">Σχετικά με εμάς</a>
        </nav>
        <div class="icons">
          <a href="#"><img src="\elements\Group 17.svg" alt="fb" class="facebook-icon"></a>
          <a href="#"><img src="\elements\mdi_instagram.svg" alt="insta" class="instagram-icon"></a>
          <a href="#"><img src="\elements\phone.svg" alt="phone"></a>
          <a href="#"><img src="\elements\mail.svg" alt="mail"></a>
        </div>
        <a href="../index2.html" class="login-btn" style="text-decoration: none;">Είσοδος</a>
      </div>
  </header>
  
  <main>
    <div class="container">
      <h1>Μηχανογραφικό Δελτίο</h1>
      
      <!-- Περιγραφή σελίδας -->
      <div class="description-section">
        <h2>Οδηγοί και Πληροφορίες για το Μηχανογραφικό</h2>
        <p>Σε αυτή τη σελίδα θα βρείτε οδηγούς συμπλήρωσης του μηχανογραφικού δελτίου, πίνακες αντιστοιχίας σχολών, και χρήσιμες πληροφορίες για την επιλογή σχολών ανά πεδίο σπουδών. Μπορείτε να φιλτράρετε τα αποτελέσματα με βάση τον τύπο λυκείου, το πεδίο σπουδών και τα ειδικά μαθήματα.</p>
      </div>
      
      <!-- Φίλτρα -->
      <div class="filters-section">
        <div class="filter-group">
          <label for="lykeio-filter">Τύπος Λυκείου:</label>
          <select id="lykeio-filter">
            <option value="">Όλα τα Λύκεια</option>
            <option value="ΓΕΛ">ΓΕΛ (Γενικό Λύκειο)</option>
            <option value="ΕΠΑΛ">ΕΠΑΛ (Επαγγελματικό Λύκειο)</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="field-filter">Πεδίο Σπουδών:</label>
          <select id="field-filter">
            <option value="">Όλα τα πεδία</option>
            <option value="Θετικές Επιστήμες">Θετικές Επιστήμες</option>
            <option value="Ανθρωπιστικές Επιστήμες">Ανθρωπιστικές Επιστήμες</option>
            <option value="Οικονομικές Επιστήμες">Οικονομικές Επιστήμες</option>
            <option value="Τεχνολογικές Επιστήμες">Τεχνολογικές Επιστήμες</option>
            <option value="Επιστήμες Υγείας">Επιστήμες Υγείας</option>
            <option value="Καλές Τέχνες">Καλές Τέχνες</option>
            <option value="Αθλητισμός">Αθλητισμός</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="specialty-filter">Ειδικά Μαθήματα:</label>
          <select id="specialty-filter">
            <option value="">Όλα τα ειδικά μαθήματα</option>
            <option value="Μουσική">Μουσική</option>
            <option value="Εικαστικά">Εικαστικά</option>
            <option value="Φυσική Αγωγή">Φυσική Αγωγή</option>
            <option value="Χορός">Χορός</option>
            <option value="Θεατρικές Σπουδές">Θεατρικές Σπουδές</option>
            <option value="Αρχιτεκτονική">Αρχιτεκτονική</option>
            <option value="Ξένες Γλώσσες">Ξένες Γλώσσες</option>
            <option value="Τεχνολογικά">Τεχνολογικά</option>
          </select>
        </div>
        
        <button id="clear-filters" class="clear-btn">Καθαρισμός Φίλτρων</button>
      </div>

      <!-- Ειδοποίηση για backend status -->
      <div id="backend-status" class="info-notice" style="display: none; background: #fff3cd; border-color: #ffeeba; color: #856404;">
        <strong> Προσοχή:</strong> 
        <span id="backend-status-text"></span>
      </div>

      <!-- Πληροφορίες αρχείων -->
      <div id="files-info" class="info-notice" style="display: none;">
        <strong> Πληροφορίες:</strong> 
        <span id="files-count-text"></span>
      </div>

      <!-- Περιοχή PDF αρχείων -->
      <div id="pdf-container" class="pdf-grid">
        <!-- Τα PDF θα φορτωθούν δυναμικά από JavaScript -->
        <div class="loading">Φόρτωση οδηγών μηχανογραφικού...</div>
      </div>

      <!-- Μήνυμα όταν δεν υπάρχουν αρχεία -->
      <div id="no-files-message" class="no-files" style="display: none;">
        <h3>Δεν υπάρχουν διαθέσιμα αρχεία</h3>
        <p>Δεν βρέθηκαν οδηγοί μηχανογραφικού που να ταιριάζουν με τα κριτήρια αναζήτησης.</p>
      </div>
    </div>
  </main>
  <footer>
    <div class="footer-content">
      <div class="footer-logo">Μαθητικό Στέκι</div>
      <div class="footer-links"  data-id="footer-links">
        <span>Καθηγητές:</span>
        <span>...</span>
      </div>
      <div class="footer-map" >
        <img src="map.png" alt="Χάρτης">
      </div>
    </div>
    <div class="footer-bottom">
      &copy; 2025 Μαθητικό Στέκι
    </div>
  </footer>
  <script src="../main.js"></script>
  <script src="../client-text.js"></script>
  <script>
    // Δυναμική φόρτωση PDF αρχείων μηχανογραφικού
    let allPDFs = [];
    let isBackendAvailable = false;
    
    // Φόρτωση αρχείων PDF από το backend
    async function loadPDFs() {
      const loadingDiv = document.querySelector('.loading');
      if (loadingDiv) loadingDiv.style.display = 'block';
      
      try {
        const response = await fetch('/api/mixanografiko');
        if (response.ok) {
          allPDFs = await response.json();
          isBackendAvailable = true;
          displayPDFs(allPDFs);
          updateFilesInfo(allPDFs.length);
          showBackendStatus();
        } else {
          throw new Error('Σφάλμα στη λήψη δεδομένων από το backend');
        }
      } catch (error) {
        console.warn('Backend δεν είναι διαθέσιμο, χρήση sample δεδομένων:', error);
        // Fallback σε sample data αν το backend δεν είναι διαθέσιμο
        isBackendAvailable = false;
        loadSampleData();
      } finally {
        if (loadingDiv) loadingDiv.style.display = 'none';
      }
    }
    
    // Fallback function με sample data
    function loadSampleData() {
      allPDFs = [
      {
        id: 1,
        title: "Οδηγός Μηχανογραφικού ΓΕΛ Θετικές Επιστήμες",
        lykeio: "ΓΕΛ",
        field: "Θετικές Επιστήμες",
        specialty: "",
        description: "Πλήρης οδηγός για τη συμπλήρωση του μηχανογραφικού για υποψηφίους θετικών επιστημών",
        filename: "odigos_mixanografikoy_gel_thetikes.pdf",
        file_size: "2.1 MB",
        upload_date: "2024-02-15"
      },
      {
        id: 2,
        title: "Πίνακας Αντιστοιχίας Σχολών Καλών Τεχνών",
        lykeio: "ΓΕΛ",
        field: "Καλές Τέχνες", 
        specialty: "Εικαστικά",
        description: "Αναλυτικός πίνακας με τις σχολές καλών τεχνών και τα μαθήματα που εξετάζουν",
        filename: "pinakas_antistixias_kales_texnes.pdf",
        file_size: "1.8 MB",
        upload_date: "2024-02-10"
      },
      {
        id: 3,
        title: "Μηχανογραφικό ΕΠΑΛ Τεχνολογικών Σπουδών",
        lykeio: "ΕΠΑΛ",
        field: "Τεχνολογικές Επιστήμες",
        specialty: "Τεχνολογικά",
        description: "Οδηγός για απόφοιτους ΕΠΑΛ που θέλουν να συνεχίσουν σε τεχνολογικές σχολές",
        filename: "mixanografiko_epal_texnologikes.pdf",
        file_size: "1.5 MB",
        upload_date: "2024-02-05"
      },
      {
        id: 4,
        title: "Ειδικά Μαθήματα Μουσικής - Οδηγίες",
        lykeio: "ΓΕΛ",
        field: "Καλές Τέχνες",
        specialty: "Μουσική",
        description: "Οδηγίες για τις εξετάσεις ειδικών μαθημάτων μουσικής και επιλογή σχολών",
        filename: "eidika_mathimata_mousiki.pdf",
        file_size: "1.2 MB",
        upload_date: "2024-01-30"
      },
      {
        id: 5,
        title: "Σχολές Φυσικής Αγωγής - Μηχανογραφικό",
        lykeio: "ΓΕΛ",
        field: "Αθλητισμός",
        specialty: "Φυσική Αγωγή",
        description: "Πληροφορίες για τις σχολές φυσικής αγωγής και αθλητισμού",
        filename: "scholes_fysikis_agogis.pdf",
        file_size: "1.7 MB",
        upload_date: "2024-01-25"
      },
      {
        id: 6,
        title: "Ανθρωπιστικές Σπουδές - Πλήρης Οδηγός",
        lykeio: "ΓΕΛ",
        field: "Ανθρωπιστικές Επιστήμες",
        specialty: "",
        description: "Αναλυτικός οδηγός για τις ανθρωπιστικές σπουδές και τις επιλογές σχολών",
        filename: "anthropistikes_spoydes_odigos.pdf",
        file_size: "2.3 MB",
        upload_date: "2024-01-20"
      }
    ];
    
    displayPDFs(allPDFs);
    updateFilesInfo(allPDFs.length);
    showBackendStatus();
    }
    
    // Εμφάνιση PDF αρχείων
    function displayPDFs(pdfs) {
      const container = document.getElementById('pdf-container');
      const noFilesMessage = document.getElementById('no-files-message');
      
      if (pdfs.length === 0) {
        container.style.display = 'none';
        noFilesMessage.style.display = 'block';
        return;
      }
      
      container.style.display = 'grid';
      noFilesMessage.style.display = 'none';
      
      container.innerHTML = pdfs.map(pdf => `
        <div class="pdf-item">
          <div class="pdf-header">
            <svg class="pdf-icon" fill="currentColor" viewBox="0 0 24 24">
              <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
            </svg>
            <h3 class="pdf-title">${pdf.title}</h3>
          </div>
          
          <div class="pdf-info">
            <div class="pdf-meta">
              <span><strong>Λύκειο:</strong> ${pdf.lykeio}</span>
              <span><strong>Μέγεθος:</strong> ${pdf.file_size}</span>
            </div>
            <div class="pdf-meta">
              <span><strong>Πεδίο:</strong> ${pdf.field}</span>
              ${pdf.specialty ? `<span class="specialty-badge">${pdf.specialty}</span>` : ''}
            </div>
            <div class="pdf-description">
              ${pdf.description || 'Οδηγός μηχανογραφικού'}
            </div>
          </div>
          
          <div class="pdf-actions">
            ${isBackendAvailable && pdf.id ? `
              <a href="/api/mixanografiko/view/${pdf.id}" target="_blank" class="btn-view">
                 Προβολή
              </a>
              <a href="/api/mixanografiko/download/${pdf.id}" download class="btn-download">
                 Λήψη
              </a>
            ` : `
              <button class="btn-view" onclick="showSampleAlert()">
                 Προβολή
              </button>
              <button class="btn-download" onclick="showSampleAlert()">
                 Λήψη
              </button>
            `}
          </div>
        </div>
      `).join('');
    }
    
    // Ειδοποίηση για sample data
    function showSampleAlert() {
      alert('Αυτό είναι δείγμα δεδομένων για επίδειξη.\n\nΓια πραγματική λειτουργία λήψης και προβολής αρχείων, παρακαλώ:\n1. Ενεργοποιήστε το backend server\n2. Ανεβάστε πραγματικά PDF αρχεία μέσω του admin panel');
    }
    
    // Εμφάνιση κατάστασης backend
    function showBackendStatus() {
      const backendStatus = document.getElementById('backend-status');
      const backendStatusText = document.getElementById('backend-status-text');
      
      if (!isBackendAvailable) {
        backendStatusText.textContent = 'Χρησιμοποιούνται δεδομένα επίδειξης. Για πλήρη λειτουργία ενεργοποιήστε το backend server.';
        backendStatus.style.display = 'block';
      } else {
        backendStatus.style.display = 'none';
      }
    }
    
    // Ενημέρωση πληροφοριών αρχείων
    function updateFilesInfo(count) {
      const filesInfo = document.getElementById('files-info');
      const filesCountText = document.getElementById('files-count-text');
      
      if (count > 0) {
        filesInfo.style.display = 'block';
        filesCountText.textContent = `Βρέθηκαν ${count} οδηγοί μηχανογραφικού`;
      } else {
        filesInfo.style.display = 'none';
      }
    }
    
    // Φιλτράρισμα αρχείων
    async function filterPDFs() {
      const lykeioFilter = document.getElementById('lykeio-filter').value;
      const fieldFilter = document.getElementById('field-filter').value;
      const specialtyFilter = document.getElementById('specialty-filter').value;
      
      if (isBackendAvailable) {
        try {
          // Κατασκευή URL με query parameters για backend filtering
          const params = new URLSearchParams();
          if (lykeioFilter) params.append('lykeio', lykeioFilter);
          if (fieldFilter) params.append('field', fieldFilter);
          if (specialtyFilter) params.append('specialty', specialtyFilter);
          
          const url = `/api/mixanografiko${params.toString() ? '?' + params.toString() : ''}`;
          const response = await fetch(url);
          
          if (response.ok) {
            const filteredPDFs = await response.json();
            displayPDFs(filteredPDFs);
            updateFilesInfo(filteredPDFs.length);
            return;
          }
        } catch (error) {
          console.warn('Backend filtering failed, using client-side filtering:', error);
        }
      }
      
      // Fallback σε client-side filtering
      clientSideFilter();
    }
    
    // Client-side filtering fallback
    function clientSideFilter() {
      const lykeioFilter = document.getElementById('lykeio-filter').value;
      const fieldFilter = document.getElementById('field-filter').value;
      const specialtyFilter = document.getElementById('specialty-filter').value;
      
      let filteredPDFs = allPDFs.filter(pdf => {
        const matchesLykeio = !lykeioFilter || pdf.lykeio === lykeioFilter;
        const matchesField = !fieldFilter || pdf.field === fieldFilter;
        const matchesSpecialty = !specialtyFilter || pdf.specialty === specialtyFilter;
        
        return matchesLykeio && matchesField && matchesSpecialty;
      });
      
      displayPDFs(filteredPDFs);
      updateFilesInfo(filteredPDFs.length);
    }
    
    // Καθαρισμός φίλτρων
    function clearFilters() {
      document.getElementById('lykeio-filter').value = '';
      document.getElementById('field-filter').value = '';
      document.getElementById('specialty-filter').value = '';
      
      // Επαναφόρτωση όλων των αρχείων
      loadPDFs();
    }
    
    // Event listeners
    document.getElementById('lykeio-filter').addEventListener('change', filterPDFs);
    document.getElementById('field-filter').addEventListener('change', filterPDFs);
    document.getElementById('specialty-filter').addEventListener('change', filterPDFs);
    document.getElementById('clear-filters').addEventListener('click', clearFilters);
    
    // Φόρτωση αρχείων κατά την εκκίνηση
    document.addEventListener('DOMContentLoaded', function() {
      loadPDFs();
    });
  </script>

</body>
</html>
